datasource db {
    provider = "mongodb"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

enum Color {
    RED
    BLUE
    GREEN
    YELLOW
}

enum MessageType {
    FILE
    TEXT
}

enum RecipientType {
    DIRECT
    GROUP
}

model User {
    id       String @id @default(auto()) @map("_id") @db.ObjectId
    username String
    password String
    email    String @unique

    picUrl   String? @default("")
    picColor Color   @default(BLUE)

    createdAt       DateTime  @default(now())
    updatedAt       DateTime  @updatedAt
    MessagesSended  Message[] @relation("UserSended")
    MessageRecipent Message[] @relation("UserRecipient")
}

model Message {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    messageType MessageType
    content     String

    sender   User   @relation("UserSended", fields: [senderId], references: [id])
    senderId String @db.ObjectId

    recipientType RecipientType
    recipient     User?         @relation("UserRecipient", references: [id], fields: [recipientId])
    recipientId   String?       @db.ObjectId
}
